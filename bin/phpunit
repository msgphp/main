#!/usr/bin/env bash

RETURN=0

for DIR in $(find src/ -maxdepth 1 -mindepth 1 -type d) ; do
    pushd $DIR &> /dev/null

    if [[ $TRAVIS = true ]] ; then
        tfold "Running PHPUnit in ${DIR}" "vendor/bin/simple-phpunit \"${@}\""
    else
        echo -e "\e[34mRunning PHPUnit in ${DIR}\e[0m"
        vendor/bin/simple-phpunit "${@}"
    fi

    LAST=$? ; [[ ${LAST} -ne 0 ]] && RETURN=${LAST}
    popd &> /dev/null
done

exit ${RETURN}
